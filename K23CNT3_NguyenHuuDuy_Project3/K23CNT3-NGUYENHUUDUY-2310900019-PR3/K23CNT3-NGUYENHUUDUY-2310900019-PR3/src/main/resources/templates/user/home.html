<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/_LayoutUser :: layout(
          'Trang chủ',
          ~{::content},
          ~{::customScripts}
      )">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<th:block th:fragment="content">
    <style>
        /* CSS cho Slider Thương hiệu */
        .brand-container { position: relative; padding: 0 40px; }
        #brandSlider {
            scroll-behavior: smooth;
            -ms-overflow-style: none;
            scrollbar-width: none;
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
        }
        #brandSlider::-webkit-scrollbar { display: none; }

        .brand-card { flex: 0 0 auto; transition: all 0.3s ease; }
        .brand-card:hover { transform: translateY(-5px); }
        .brand-card:hover .card { border: 1px solid #ffc107 !important; }

        /* CSS cho Sản phẩm & Banner */
        .carousel-item img { border-radius: 20px; object-fit: cover; height: 450px; }
        .product-card { border: none; border-radius: 16px; overflow: hidden; transition: all 0.3s ease; background: #fff; }
        .product-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.1) !important; }
        .product-img-wrapper { position: relative; overflow: hidden; height: 220px; display: flex; align-items: center; justify-content: center; }
        .product-card img { transition: transform 0.5s ease; }
        .product-card:hover img { transform: scale(1.1); }

        .cate-item { padding: 25px; border-radius: 20px; background: #fff; transition: all 0.3s; border: 1px solid #f1f5f9; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .cate-item i { font-size: 2rem; color: #ffc107; }
        .cate-item:hover { background: #fff9e6; border-color: #ffc107; transform: translateY(-5px); }
    </style>

    <section id="hero-slider" class="mb-5">
        <div id="mainCarousel" class="carousel slide carousel-fade shadow-sm" data-bs-ride="carousel" data-bs-interval="3000">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="2"></button>
            </div>

            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img th:src="@{/uploads/banner/lycy2.png}" class="d-block w-100" alt="Banner 1">
                </div>
                <div class="carousel-item">
                    <img th:src="@{/uploads/banner/banner2.jpg}" class="d-block w-100" alt="Banner 2">
                </div>
                <div class="carousel-item">
                    <img th:src="@{/uploads/banner/lucy3.jpg}" class="d-block w-100" alt="Banner 3">
                </div>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon p-3 bg-dark rounded-circle"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon p-3 bg-dark rounded-circle"></span>
            </button>
        </div>
    </section>

    <section class="mb-5">
        <h4 class="fw-bold mb-4">Thương hiệu <span class="text-warning">Đối tác</span></h4>
        <div class="brand-container">
            <button class="btn btn-light shadow-sm position-absolute top-50 start-0 translate-middle-y z-3 rounded-circle"
                    onclick="scrollBrands(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div id="brandSlider">
                <div th:each="th : ${dsThuongHieu}" class="brand-card">
                    <a th:href="@{/sanpham(thuongHieuId=${th.id})}" class="text-decoration-none">
                        <div class="card h-100 border-0 shadow-sm p-3 text-center" style="min-width: 180px;">
                            <img th:src="@{'/images/brands/' + ${th.logo}}" class="img-fluid mx-auto mb-2" style="height: 50px; width: 100px; object-fit: contain;">
                            <span class="small fw-bold text-dark text-uppercase" th:text="${th.tenThuongHieu}">Tên TH</span>
                        </div>
                    </a>
                </div>
            </div>

            <button class="btn btn-light shadow-sm position-absolute top-50 end-0 translate-middle-y z-3 rounded-circle"
                    onclick="scrollBrands(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </section>

    <section class="mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold m-0">Sản phẩm mới nhất</h4>
            <a th:href="@{/sanpham}" class="btn btn-warning text-white fw-bold rounded-pill px-4">Xem tất cả</a>
        </div>

        <div class="row g-4">
            <div class="col-6 col-md-3" th:each="sp : ${dsSanPham}">
                <div class="card product-card h-100 shadow-sm">
                    <div class="product-img-wrapper">
                        <img th:src="@{'/images/product/' + ${sp.hinhAnh}}" class="card-img-top p-3" alt="Sản phẩm">
                        <span class="position-absolute top-0 start-0 m-3 badge bg-danger rounded-pill shadow-sm">Mới</span>
                    </div>
                    <div class="card-body text-center p-3">
                        <h6 class="card-title fw-bold mb-2 text-truncate" th:text="${sp.tenSanPham}">Tên SP</h6>
                        <p class="text-primary fs-5 fw-bold mb-0"
                           th:text="${#numbers.formatDecimal(sp.gia, 0, 'COMMA', 0, 'POINT')} + ' đ'"></p>

                        <form th:action="@{/giohang/add}" method="post">
                            <input type="hidden" name="id" th:value="${sp.id}">
                            <button type="submit" class="btn btn-warning btn-sm mt-3 w-100 rounded-pill fw-bold text-white shadow-sm">
                                <i class="fas fa-cart-plus me-1"></i> Thêm vào giỏ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="mb-5 py-5 bg-light rounded-5 px-4">
        <h4 class="fw-bold text-center mb-5">Danh mục nổi bật</h4>
        <div class="row g-4 justify-content-center">
            <div class="col-6 col-md-2" th:each="cat : ${ {'ximang', 'satthep', 'tonlop', 'gachda', 'son'} }">
                <a th:href="@{/sanpham(danhmuc=${cat})}" class="text-decoration-none">
                    <div class="cate-item shadow-sm">
                        <i class="fa-solid"
                           th:classappend="${cat == 'ximang' ? 'fa-trowel-bricks' :
                               (cat == 'satthep' ? 'fa-fill-drip' :
                               (cat == 'tonlop'  ? 'fa-layer-group' :
                               (cat == 'gachda'  ? 'fa-cubes' :
                               (cat == 'son'     ? 'fa-paint-roller' : 'fa-box'))))}"></i>

                        <p class="mb-0 fw-bold text-dark text-capitalize"
                           th:text="${cat == 'gachda' ? 'Gạch Đá' :
                         (cat == 'ximang' ? 'Xi Măng' :
                         (cat == 'satthep' ? 'Sắt Thép' :
                         (cat == 'tonlop' ? 'Tôn Lợp' :
                         (cat == 'son' ? 'Sơn' : cat))))}"></p>
                    </div>
                </a>
            </div>
        </div>
    </section>
</th:block>

<th:block th:fragment="customScripts">
    <script>
        // Điều khiển nút bấm cho Brand Slider
        function scrollBrands(direction) {
            const slider = document.getElementById('brandSlider');
            const scrollAmount = 250;
            slider.scrollLeft += (direction * scrollAmount);
        }

        // Tự động chạy Slider Thương hiệu sau mỗi 4 giây
        let brandAutoScroll = setInterval(() => {
            const slider = document.getElementById('brandSlider');
            if (slider.scrollLeft + slider.clientWidth >= slider.scrollWidth) {
                slider.scrollLeft = 0; // Quay lại đầu nếu hết
            } else {
                slider.scrollLeft += 200;
            }
        }, 4000);

        // Dừng cuộn thương hiệu khi người dùng di chuột vào
        document.getElementById('brandSlider').addEventListener('mouseenter', () => clearInterval(brandAutoScroll));
    </script>
</th:block>
</html>