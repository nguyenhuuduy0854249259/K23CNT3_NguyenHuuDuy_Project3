<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/_LayoutUser :: layout(
          'Trang chủ',
          ~{::content},
          ~{::customScripts}
      )">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<th:block th:fragment="content">
    <style>
        /* 1. CSS CHO SLIDER THƯƠNG HIỆU (BRAND PARTNERS) */
        .brand-container {
            position: relative;
            padding: 0 50px; /* Tăng padding để nút không đè lên card */
        }

        #brandSlider {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding: 15px 5px;
            /* Ẩn thanh cuộn */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        #brandSlider::-webkit-scrollbar { display: none; }

        .brand-card {
            flex: 0 0 auto;
            width: 200px; /* Cố định độ rộng để slider đều nhau */
        }

        .brand-card .card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 1px solid #f1f5f9 !important;
        }

        .brand-card:hover { transform: translateY(-8px); }
        .brand-card:hover .card {
            border-color: #ffc107 !important;
            box-shadow: 0 10px 20px rgba(255, 193, 7, 0.15) !important;
        }

        /* 2. CSS CHO DANH MỤC NỔI BẬT (CATEGORY ITEMS) */
        .cate-item {
            padding: 30px 20px;
            border-radius: 20px;
            background: #ffffff;
            transition: all 0.3s ease;
            border: 1px solid #f1f5f9;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            height: 100%; /* Đảm bảo các ô cao bằng nhau trong row */
        }

        .cate-item .icon-wrapper i {
            font-size: 2.5rem; /* Tăng kích thước icon */
            color: #ffc107;
            transition: transform 0.3s ease;
        }

        .cate-item:hover {
            background: #fff;
            border-color: #ffc107;
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.08) !important;
        }

        .cate-item:hover .icon-wrapper i {
            transform: scale(1.2); /* Icon phóng to nhẹ khi hover */
        }

        /* 3. CSS CHO SẢN PHẨM & BANNER */
        .carousel-item img {
            border-radius: 25px;
            object-fit: cover;
            height: 480px;
        }

        .product-card {
            border: none;
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s ease;
            background: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }

        .product-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12) !important;
        }

        .product-img-wrapper {
            position: relative;
            overflow: hidden;
            height: 240px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8fafc;
        }

        .product-card img {
            transition: transform 0.6s cubic-bezier(0.33, 1, 0.68, 1);
            max-width: 100%;
            height: auto;
        }

        .product-card:hover img { transform: scale(1.15); }

        /* Nút bấm di chuyển slider thương hiệu */
        .brand-container .btn-light {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            color: #334155;
            transition: all 0.3s;
        }

        .brand-container .btn-light:hover {
            background: #ffc107;
            color: #fff;
        }
    </style>

    <section id="hero-slider" class="mb-5">
        <div id="mainCarousel" class="carousel slide carousel-fade shadow-sm" data-bs-ride="carousel" data-bs-interval="3000">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="2"></button>
            </div>

            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img th:src="@{/uploads/banner/lycy2.png}" class="d-block w-100" alt="Banner 1">
                </div>
                <div class="carousel-item">
                    <img th:src="@{/uploads/banner/banner2.jpg}" class="d-block w-100" alt="Banner 2">
                </div>
                <div class="carousel-item">
                    <img th:src="@{/uploads/banner/lucy3.jpg}" class="d-block w-100" alt="Banner 3">
                </div>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon p-3 bg-dark rounded-circle"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon p-3 bg-dark rounded-circle"></span>
            </button>
        </div>
    </section>

    <section class="mb-5">
        <h4 class="fw-bold mb-4">Thương hiệu <span class="text-warning">Đối tác</span></h4>
        <div class="brand-container position-relative"> <button class="btn btn-light shadow-sm position-absolute top-50 start-0 translate-middle-y z-3 rounded-circle"
                                                                onclick="scrollBrands(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>

            <div id="brandSlider" class="d-flex overflow-hidden gap-3 py-2"> <div th:each="th : ${dsThuongHieu}" class="brand-card">
                <a th:href="@{/sanpham(thuongHieuId=${th.id})}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm p-3 text-center" style="min-width: 180px; transition: transform 0.3s;">
                        <img th:if="${th.logo != null}"
                             th:src="@{'/uploads/' + ${th.logo}}"
                             class="img-fluid mx-auto mb-2"
                             style="height: 50px; width: 100px; object-fit: contain;"
                             th:alt="${th.ten}">

                        <img th:unless="${th.logo != null}"
                             src="https://via.placeholder.com/100x50?text=No+Logo"
                             class="img-fluid mx-auto mb-2">

                        <span class="small fw-bold text-dark text-uppercase d-block" th:text="${th.ten}">Tên TH</span>
                    </div>
                </a>
            </div>
            </div>

            <button class="btn btn-light shadow-sm position-absolute top-50 end-0 translate-middle-y z-3 rounded-circle"
                    onclick="scrollBrands(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </section>

    <section class="mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold m-0">Sản phẩm <span class="text-warning">mới nhất</span></h4>
            <a th:href="@{/sanpham}" class="btn btn-warning text-white fw-bold rounded-pill px-4">Xem tất cả</a>
        </div>

        <div class="row g-4 row-cols-2 row-cols-md-3 row-cols-lg-5">
            <div class="col" th:each="sp : ${dsSanPham}">
                <div class="card product-card h-100 shadow-sm border-0">
                    <div class="product-img-wrapper">
                        <img th:src="${sp.hinhAnh != null ? '/uploads/' + sp.hinhAnh : 'https://via.placeholder.com/200'}"
                             class="card-img-top p-3" alt="Sản phẩm" style="object-fit: contain;">
                        <span class="position-absolute top-0 start-0 m-2 badge bg-danger rounded-pill shadow-sm">Mới</span>
                    </div>
                    <div class="card-body text-center p-3 d-flex flex-column">
                        <h6 class="card-title fw-bold mb-2 text-truncate" th:text="${sp.ten}">Tên SP</h6>

                        <p class="text-danger fs-6 fw-bold mb-0 mt-auto"
                           th:text="${#numbers.formatDecimal(sp.gia, 0, 'POINT', 0, 'COMMA')} + ' ₫'"></p>

                        <form th:action="@{/giohang/add}" method="post" class="mt-3">
                            <input type="hidden" name="id" th:value="${sp.id}">
                            <button type="submit" class="btn btn-warning btn-sm w-100 rounded-pill fw-bold text-white shadow-sm">
                                <i class="fas fa-cart-plus me-1"></i> Thêm vào giỏ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="mb-5 py-5 bg-light rounded-5 px-4">
        <h4 class="fw-bold text-center mb-5">Danh mục <span class="text-primary">Nổi bật</span></h4>
        <div class="row g-4 justify-content-center">
            <div class="col-6 col-md-2" th:each="dm : ${dsDanhMuc}" th:if="${dm.parent == null}">
                <a th:href="@{/sanpham(danhMucId=${dm.id})}" class="text-decoration-none">
                    <div class="cate-item shadow-sm text-center p-4 bg-white rounded-4 transition-hover">
                        <div class="icon-wrapper mb-3">
                            <i class="fa-solid fa-2x text-primary"
                               th:classappend="${dm.ten.toLowerCase().contains('xi măng') ? 'fa-trowel-bricks' :
                                           (dm.ten.toLowerCase().contains('sắt') ? 'fa-link' :
                                           (dm.ten.toLowerCase().contains('tôn') ? 'fa-layer-group' :
                                           (dm.ten.toLowerCase().contains('gạch') ? 'fa-cubes' :
                                           (dm.ten.toLowerCase().contains('sơn') ? 'fa-paint-roller' : 'fa-box'))))}">
                            </i>
                        </div>

                        <p class="mb-0 fw-bold text-dark text-capitalize" th:text="${dm.ten}">Tên Danh Mục</p>

                        <small class="text-muted" th:text="${#lists.size(dm.sanPhams)} + ' sản phẩm'"></small>
                    </div>
                </a>
            </div>
        </div>
    </section>
</th:block>

<th:block th:fragment="customScripts">
    <script>
        // Điều khiển nút bấm cho Brand Slider
        function scrollBrands(direction) {
            const slider = document.getElementById('brandSlider');
            const scrollAmount = 250;
            slider.scrollLeft += (direction * scrollAmount);
        }

        // Tự động chạy Slider Thương hiệu sau mỗi 4 giây
        let brandAutoScroll = setInterval(() => {
            const slider = document.getElementById('brandSlider');
            if (slider.scrollLeft + slider.clientWidth >= slider.scrollWidth) {
                slider.scrollLeft = 0; // Quay lại đầu nếu hết
            } else {
                slider.scrollLeft += 200;
            }
        }, 4000);

        // Dừng cuộn thương hiệu khi người dùng di chuột vào
        document.getElementById('brandSlider').addEventListener('mouseenter', () => clearInterval(brandAutoScroll));
    </script>
</th:block>
</html>