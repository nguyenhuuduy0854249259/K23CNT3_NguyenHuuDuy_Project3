<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{admin/layout/header :: admin_head}"></head>

<style>
    /* Giữ nguyên CSS của bạn vì nó đã khá ổn */
    body { background-color: #f4f6f9; font-family: Arial, Helvetica, sans-serif; }
    h2 { font-weight: 700; margin: 20px 0; color: #2c3e50; }
    .btn-add { background: linear-gradient(135deg, #4e73df, #224abe); color: #fff; padding: 8px 14px; border-radius: 6px; text-decoration: none; font-weight: 600; font-size: 14px; }
    .btn-add:hover { opacity: 0.9; color: #fff; }
    table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 14px rgba(0,0,0,0.08); }
    thead { background-color: #343a40; color: #fff; }
    th, td { padding: 12px 10px; text-align: center; vertical-align: middle; font-size: 14px; }
    tbody tr:nth-child(even) { background-color: #f8f9fc; }
    tbody tr:hover { background-color: #eef1f7; }
    /* Style cho ảnh thumbnail */
    .img-thumb { width: 70px; height: 70px; object-fit: cover; border-radius: 6px; border: 1px solid #ddd; }
    .btn-action { margin: 0 3px; }
</style>

<body>

<div th:replace="~{admin/layout/header :: admin_navbar}"></div>

<div class="container-fluid mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2><i class="bi bi-box-seam"></i> Quản lý sản phẩm</h2>
        <a th:href="@{/admin/sanpham/create}" class="btn-add">
            <i class="bi bi-plus-circle"></i> Thêm sản phẩm mới
        </a>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body p-0">
            <table class="table mb-0">
                <thead class="table-dark text-center">
                <tr>
                    <th>ID</th>
                    <th>Hình ảnh</th>
                    <th>Tên sản phẩm</th>
                    <th>Danh mục / Thương hiệu</th>
                    <th>Giá bán</th>
                    <th>Tồn kho</th>
                    <th>Hành động</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="sp : ${list}">
                    <td th:text="${sp.id}"></td>
                    <td>
                        <img th:if="${sp.hinhAnh != null and sp.hinhAnh != ''}"
                             th:src="@{'/uploads/' + ${sp.hinhAnh}}"
                             class="img-thumb" alt="Sản phẩm">

                        <img th:unless="${sp.hinhAnh != null and sp.hinhAnh != ''}"
                             src="https://via.placeholder.com/70x70?text=No+Img"
                             class="img-thumb" alt="Không có ảnh">
                    </td>
                    <td class="text-start">
                        <strong th:text="${sp.ten}" class="text-primary"></strong><br>
                        <small class="text-muted" th:text="${sp.moTa != null ? #strings.abbreviate(sp.moTa, 50) : ''}"></small>
                    </td>
                    <td>
                        <span class="badge bg-info text-dark mb-1" th:text="${sp.danhMuc != null ? sp.danhMuc.ten : 'Chưa phân loại'}"></span><br>
                        <span class="badge bg-light text-dark border" th:text="${sp.thuongHieu != null ? sp.thuongHieu.ten : 'Chưa có TH'}"></span>
                    </td>
                    <td class="text-danger fw-bold" th:text="${#numbers.formatDecimal(sp.gia, 0, 'POINT', 0, 'COMMA')} + ' ₫'"></td>
                    <td>
                        <span th:classappend="${sp.soLuongTon < 5} ? 'badge bg-danger' : 'badge bg-success'"
                              th:text="${sp.soLuongTon}"></span>
                    </td>
                    <td>
                        <a th:href="@{/admin/sanpham/edit/{id}(id=${sp.id})}" class="btn btn-sm btn-warning btn-action">
                            <i class="bi bi-pencil-square"></i>Sửa
                        </a>
                        <a th:href="@{/admin/sanpham/delete/{id}(id=${sp.id})}"
                           class="btn btn-sm btn-danger btn-action"
                           onclick="return confirm('Bạn có chắc chắn muốn xóa sản phẩm này? Hành động này không thể hoàn tác!')">
                            <i class="bi bi-trash"></i>Xoá
                        </a>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(list)}">
                    <td colspan="7" class="text-center py-5 text-muted fst-italic">
                        <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                        Chưa có sản phẩm nào trong hệ thống.
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>